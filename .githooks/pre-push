#!/bin/bash

echo "Running pre-push checks..."

# Frontend checks
echo "ğŸ” Running frontend lint checks..."
cd frontend
npm run lint
if [ $? -ne 0 ]; then
    echo "âŒ Frontend lint check failed. Please fix linting errors before pushing."
    exit 1
fi
cd ..

# Backend checks
echo "ğŸ” Running backend checks..."
cd backend

# Run dotnet format with verification
dotnet format --verify-no-changes
if [ $? -ne 0 ]; then
    echo "âŒ Code formatting check failed. Please run 'dotnet format --verify-no-changes' to see and fix formatting issues."
    exit 1
fi

# Run dotnet build
dotnet build
if [ $? -ne 0 ]; then
    echo "âŒ Build failed. Please fix build errors before pushing."
    exit 1
fi

# Run tests
dotnet test --no-build
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed. Please fix failing tests before pushing."
    exit 1
fi

cd ..

echo "âœ… All pre-push checks passed!"
exit 0
